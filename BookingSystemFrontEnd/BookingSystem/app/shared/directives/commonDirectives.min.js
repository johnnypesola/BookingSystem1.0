(function(){var isValueEmpty=function(value){return angular.isUndefined(value)||value===""||value===null||value!==value};angular.module("bookingSystem.commonDirectives",[]).directive("pageHeaderButtons",["$route","$routeParams","$location",function($route,$routeParams,$location){return{restrict:"E",replace:true,templateUrl:"shared/directives/pageHeaderButtons.html",scope:{showList:"=showList",showCalendar:"=showCalendar",showMap:"=showMap",showAdd:"=showAdd",showSearch:"=showSearch"},controller:["$scope","$element","$attrs",function($scope,$element,$attrs){$scope.objectType=$location.path().split("/")[1];$scope.activePage=$location.path().split("/")[2]}]}}]).directive("selectPercentage",function(){return{restrict:"E",replace:true,template:'<select ng-model="model" ng-options="percentage.value as percentage.name for percentage in percentageRange"></select>',scope:{model:"=useModel"},controller:["$scope","$element","$attrs",function($scope,$element,$attrs){var i;$scope.percentageRange=[];$scope.model=$scope.model||0;for(i=0;i<=100;i++){$scope.percentageRange.push({name:i+"%",value:i/100})}}]}}).directive("selectMaxPeople",["OPTIONS_MAX_PEOPLE",function(OPTIONS_MAX_PEOPLE){return{restrict:"E",require:"ngModel",replace:true,template:'<div><span ng-show="isErrorVisible">Max {{maxPeopleOptions}}</span><select ng-model="model" ng-options="maxPeople for maxPeople in maxPeopleRange"></select></div>',scope:{model:"=useModel",maxPeopleOptions:"=maxPeopleOptions"},link:function(scope,elem,attr,ctrl){var i,that=this;scope.isErrorVisible=false;that.generateOptions=function(){scope.maxPeopleRange=[];for(i=0;i<=OPTIONS_MAX_PEOPLE;i++){scope.maxPeopleRange.push(i)}};scope.model=scope.model||0;scope.$watch("maxPeopleOptions",function(){if(scope.model>scope.maxPeopleOptions){scope.isErrorVisible=true;ctrl.$setValidity("dateTimeOutOfRange",false)}else{scope.isErrorVisible=false;ctrl.$setValidity("dateTimeOutOfRange",true)}});scope.$watch("model",function(){if(scope.model>scope.maxPeopleOptions){scope.isErrorVisible=true;ctrl.$setValidity("dateTimeOutOfRange",false)}else{scope.isErrorVisible=false;ctrl.$setValidity("dateTimeOutOfRange",true)}});that.generateOptions()},controller:["$scope","$element","$attrs",function($scope,$element,$attrs){}]}}]).directive("inputMaxPeople",function(){return{restrict:"E",replace:true,template:'<div><input type="number" ng-model="model" min="0" max="{{maxPeople}}">{{maxPeople}}</div>',scope:{model:"=useModel",maxPeople:"=maxPeople"},controller:["$scope","$element","$attrs",function($scope,$element,$attrs){var i,that=this;$scope.model=$scope.model||0;if($scope.model>$scope.maxPeople){$scope.model=0}$scope.$watch("maxPeople",function(){if($scope.model>$scope.maxPeople){$scope.model=0}})}]}}).directive("loading",["$http",function($http){return{restrict:"A",link:function(scope,elm,attrs){scope.isLoading=function(){return $http.pendingRequests.length>0};scope.$watch(scope.isLoading,function(v){if(v){scope.showPreLoader=true}else{scope.showPreLoader=false}})}}}]).directive("itemActionButtons",["$route","$routeParams","$location",function($route,$routeParams,$location){return{restrict:"A",replace:true,templateUrl:"shared/directives/itemActionButtons.html",scope:{id:"=itemActionButtons",objectType:"@objectType",bookingType:"@bookingType",renderDeleteIcon:"=?renderDeleteIcon",renderEditIcon:"=?renderEditIcon",renderShowIcon:"=?renderShowIcon",renderBookIcon:"=?renderBookIcon"},link:function(){},controller:["$scope","$element","$attrs",function($scope,$element,$attrs){var that=this;that.initVariables=function(){$scope.renderDeleteIcon=$scope.renderDeleteIcon||true;$scope.renderEditIcon=$scope.renderDeleteIcon||true;$scope.renderShowIcon=$scope.renderDeleteIcon||true};that.bindEvents=function(){$element.bind("click",function(event){$scope.actionsvisible=true;$scope.$digest()});$element.bind("mouseleave",function(event){$scope.actionsvisible=false;$scope.$digest()})};that.getObjectType=function(){return typeof $scope.objectType!=="undefined"?$scope.objectType:$location.path().split("/")[1]};$scope.redirectToDeletePage=function(){$location.url($location.path());$location.path(that.getObjectType()+"/radera/"+$scope.id)};$scope.redirectToEditPage=function(){$location.url($location.path());$location.path(that.getObjectType()+"/redigera/"+$scope.id)};$scope.redirectToShowPage=function(){$location.url($location.path());$location.path(that.getObjectType()+"/visa/"+$scope.id)};$scope.redirectToBookingPage=function(){$location.url($location.path());$location.path($scope.bookingType+"/skapa");$location.search("lokal-id",$scope.id)};that.bindEvents();that.initVariables()}]}}]).directive("backButton",function(){return{restrict:"A",link:function(scope,element){element[0].addEventListener("click",function(){history.back()})}}}).directive("addToContentButton",["$route","$routeParams","$location",function($route,$routeParams,$location){return{restrict:"A",replace:true,template:'<a href="" ng-click="redirect()" class="add-to-content-button">+</a>',scope:{addArgument:"=addArgument",objectType:"@addToContentButton"},link:function(){},controller:["$scope","$element","$attrs",function($scope,$element,$attrs){$scope.redirect=function(){$location.path($scope.objectType+"/skapa/"+$scope.addArgument)}}]}}]).directive("stopParentEvent",function(){return{restrict:"A",link:function(scope,element,attr){element.bind(attr.stopParentEvent,function(e){e.stopPropagation();e.preventDefault()})}}}).directive("ngMin",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){scope.$watch(attr.ngMin,function(){ctrl.$setViewValue(ctrl.$viewValue)});var minValidator=function(value){var min=scope.$eval(attr.ngMin)||0;if(!isValueEmpty(value)&&value<min){ctrl.$setValidity("ngMin",false);return undefined}else{ctrl.$setValidity("ngMin",true);return value}};ctrl.$parsers.push(minValidator);ctrl.$formatters.push(minValidator)}}}).directive("ngMax",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){function isEmpty(value){return angular.isUndefined(value)||value===""||value===null||value!==value}scope.$watch(attr.ngMax,function(){ctrl.$setViewValue(ctrl.$viewValue)});var maxValidator=function(value){var max=scope.$eval(attr.ngMax)||Infinity;if(!isValueEmpty(value)&&value>max){ctrl.$setValidity("ngMax",false);return undefined}else{ctrl.$setValidity("ngMax",true);return value}};ctrl.$parsers.push(maxValidator);ctrl.$formatters.push(maxValidator)}}}).directive("validateDateTime",function(){return{restrict:"E",require:"ngModel",link:function(scope,element,attr,ctrl){var validateDateTime;validateDateTime=function(){var StartDateObj,EndDateObj;if(typeof scope.StartDate!=="undefined"&&typeof scope.StartTime!=="undefined"&&typeof scope.EndDate!=="undefined"&&typeof scope.EndTime!=="undefined"){StartDateObj=moment(scope.StartDate+" "+scope.StartTime).toDate();EndDateObj=moment(scope.EndDate+" "+scope.EndTime).toDate();if(EndDateObj>StartDateObj){ctrl.$setValidity("dateTimeOutOfRange",true)}else{ctrl.$setValidity("dateTimeOutOfRange",false)}}};scope.$watch("StartDate",function(newValue,oldValue){validateDateTime()},true);scope.$watch("StartTime",function(newValue,oldValue){validateDateTime()},true);scope.$watch("EndDate",function(newValue,oldValue){validateDateTime()},true);scope.$watch("EndTime",function(newValue,oldValue){validateDateTime()},true)}}})})();