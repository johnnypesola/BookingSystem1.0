describe("module: bookingSystem.bookingType",function(){beforeEach(module("bookingSystem"));beforeEach(module("bookingSystem.bookingType"));beforeEach(module("bookingSystem.commonFilters"));var BookingTypeListCtrl,BookingTypeCreateCtrl,BookingTypeEditCtrl;var testCurrentDateObj;var $scope;var $location;var $rootScope;beforeEach(function(){module(function($provide){$provide.factory("BookingType",function($q){return{get:jasmine.createSpy("get").andCallFake(function(){return TestHelper.addPromiseToObject(TestHelper.JSON.getBookingType,$q)}),query:jasmine.createSpy("query").andCallFake(function(){return TestHelper.addPromiseToObject(TestHelper.JSON.queryBookingType,$q)}),save:jasmine.createSpy("save").andCallFake(function(){return TestHelper.addPromiseToObject({},$q)}),"delete":jasmine.createSpy("delete").andCallFake(function(){return TestHelper.addPromiseToObject({},$q)})}})})});beforeEach(inject(function($controller,_BookingType_,_$location_,$rootScope,_Redirect_){$location=_$location_;$scope=$rootScope;BookingTypeCreateCtrl=$controller("BookingTypeCreateCtrl",{$scope:$scope,BookingType:_BookingType_,$rootScope:$rootScope,Redirect:_Redirect_})}));describe("BookingTypeCreateCtrl controller",function(){it("should call history.back() and create a FlashMessage after successful BookingType creation",inject(function($rootScope,$controller,_BookingType_,Redirect){spyOn(Redirect,"to");$scope.bookingType=TestHelper.JSON.createBookingType;$scope.save();expect(_BookingType_.save).toHaveBeenCalledWith(TestHelper.JSON.createBookingType);$scope.$digest();expect($rootScope.FlashMessage).toBeDefined();expect(Redirect.to).toHaveBeenCalled()}));it("should create a FlashMessage after duplicate BookingType creation",inject(function($rootScope,$controller,_BookingType_,$q){_BookingType_.save=jasmine.createSpy("save").andCallFake(function(){return TestHelper.addPromiseToObject({},$q,"409","There is already a BookingType with the given name.")});spyOn(history,"back");$scope.bookingType={Name:"Test"};$scope.save();$scope.$digest();expect($rootScope.FlashMessage).toBeDefined();expect($rootScope.FlashMessage.message).toEqual('Det finns redan en bokningstyp som heter "Test". Två bokningstyper kan inte heta lika.');expect(history.back).not.toHaveBeenCalled()}));it("should create a FlashMessage after unsuccessful BookingType creation",inject(function($rootScope,$controller,_BookingType_,$q){_BookingType_.save=jasmine.createSpy("save").andCallFake(function(){return TestHelper.addPromiseToObject({},$q,"500")});spyOn(history,"back");$scope.bookingType={Name:"Test"};$scope.save();$scope.$digest();expect($rootScope.FlashMessage).toBeDefined();expect($rootScope.FlashMessage.message).toEqual("Ett oväntat fel uppstod när bokningstypen skulle sparas");expect(history.back).not.toHaveBeenCalled()}))})});