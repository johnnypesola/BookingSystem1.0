(function(){angular.module("bookingSystem.resource",["bookingSystem.resourceServices","bookingSystem.commonFilters","bookingSystem.commonDirectives"]).config(["$routeProvider",function($routeProvider){}]).controller("ResourceShowCtrl",["$scope","$routeParams","$location","$rootScope","Resource",function($scope,$routeParams,$location,$rootScope,Resource){var that=this;$scope.resource=Resource.get({resourceId:$routeParams.resourceId});$scope.resource.$promise.catch(function(){$rootScope.FlashMessage={type:"error",message:"Resursen kunde inte hämtas, var god försök igen."};$scope.resource=null})}]).controller("ResourceListCtrl",["$scope","Resource","$rootScope",function($scope,Resource,$rootScope){$scope.resources=Resource.query();$scope.resources.$promise.catch(function(){$rootScope.FlashMessage={type:"error",message:"Resurser kunde inte hämtas, var god försök igen."}})}]).controller("ResourceCreateCtrl",["$scope","$routeParams","$location","$rootScope","Resource",function($scope,$routeParams,$location,$rootScope,Resource){var that=this;$scope.save=function(){Resource.save({ResourceId:0,Name:$scope.resource.Name,Count:$scope.resource.Count,BookingPricePerHour:$scope.resource.BookingPricePerHour,MinutesMarginAfterBooking:$scope.resource.MinutesMarginAfterBooking,WeekEndCount:$scope.resource.WeekEndCount}).$promise.then(function(response){$rootScope.FlashMessage={type:"success",message:'Resursen "'+$scope.resource.Name+'" skapades med ett lyckat resultat'};history.back()}).catch(function(response){if(response.status==409){$rootScope.FlashMessage={type:"error",message:'Det finns redan en resurs som heter "'+$scope.resource.Name+'". Två resurser kan inte heta lika.'}}else{$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när resursen skulle sparas"}}})}}]).controller("ResourceEditCtrl",["$scope","$routeParams","$location","$rootScope","Resource",function($scope,$routeParams,$location,$rootScope,Resource){var that=this;$scope.save=function(){Resource.save({ResourceId:$routeParams.resourceId,Name:$scope.resource.Name,Count:$scope.resource.Count,BookingPricePerHour:$scope.resource.BookingPricePerHour,MinutesMarginAfterBooking:$scope.resource.MinutesMarginAfterBooking,WeekEndCount:$scope.resource.WeekEndCount}).$promise.then(function(response){$rootScope.FlashMessage={type:"success",message:'Resursen "'+$scope.resource.Name+'" sparades med ett lyckat resultat'};history.back()}).catch(function(response){if(response.status==409){$rootScope.FlashMessage={type:"error",message:'Det finns redan en resurs som heter "'+$scope.resource.Name+'". Två resurser kan inte heta lika.'}}else if(response.status==400||response.status==500){$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när resursen skulle sparas"}}if(response.status==404){$rootScope.FlashMessage={type:"error",message:'Resursen "'+$scope.resource.Name+'" existerar inte längre. Hann kanske någon radera den?'};history.back()}})};$scope.resource=Resource.get({resourceId:$routeParams.resourceId});$scope.resource.$promise.catch(function(){$rootScope.FlashMessage={type:"error",message:"Resursen kunde inte hämtas, var god försök igen."};$scope.resource=null})}]).controller("ResourceDeleteCtrl",["$scope","$routeParams","Resource","$location","$rootScope",function($scope,$routeParams,Resource,$location,$rootScope){var that=this;$scope.confirm=function(){Resource.delete({resourceId:$routeParams.resourceId}).$promise.then(function(response){$rootScope.FlashMessage={type:"success",message:'Resursen "'+$scope.resource.Name+'" raderades med ett lyckat resultat'};history.back()}).catch(function(response){if(response.status==400&&response.data.Message!=="undefined"&&response.data.Message==="Foreign key references exists"){$rootScope.FlashMessage={type:"error",message:"Resursen kan inte raderas eftersom det finns"+" en resursbokning som refererar till resursen"}}else if(response.status==400||response.status==500){$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när resursen skulle tas bort"}}if(response.status==404){$rootScope.FlashMessage={type:"error",message:'Resursen "'+$scope.resource.Name+'" existerar inte längre. Hann kanske någon radera den?'}}history.back()})};$scope.resource=Resource.get({resourceId:$routeParams.resourceId});$scope.resource.$promise.catch(function(){$rootScope.FlashMessage={type:"error",message:"Resursen kunde inte hämtas, var god försök igen."};$scope.resource=null})}])})();