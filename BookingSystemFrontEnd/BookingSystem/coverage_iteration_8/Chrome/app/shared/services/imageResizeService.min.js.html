<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for ./app/shared/services/imageResizeService.min.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../../prettify.css">
    <link rel="stylesheet" href="../../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header low">
    <h1>Code coverage report for <span class="entity">./app/shared/services/imageResizeService.min.js</span></h1>
    <h2>
        Statements: <span class="metric">4.41% <small>(3 / 68)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">0% <small>(0 / 6)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">12.5% <small>(1 / 8)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">100% <small>(1 / 1)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; <a href="index.html">./app/shared/services/</a> &#187; imageResizeService.min.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1</td><td class="line-coverage"><span class="cline-any cline-yes">1</span></td><td class="text"><pre class="prettyprint lang-js">(function(){angular.module("bookingSystem.imageResizeServices",[]).factory("ImageResize",["UPLOAD_IMG_MAX_WIDTH","UPLOAD_IMG_MAX_HEIGHT","$q",<span class="fstat-no" title="function not covered" >function(UPLOAD_IMG_MAX_WIDTH,UPLOAD_IMG_MAX_HEIGHT,$q){<span class="cstat-no" title="statement not covered" ></span>var img,canvas,deferred;<span class="cstat-no" title="statement not covered" >v</span>ar scaleCanvasWithAlgorithm=<span class="fstat-no" title="function not covered" >function(canvas){<span class="cstat-no" title="statement not covered" ></span>var scaledCanvas=document.createElement("canvas");<span class="cstat-no" title="statement not covered" >v</span>ar scale=UPLOAD_IMG_MAX_WIDTH/canvas.width;<span class="cstat-no" title="statement not covered" >s</span>caledCanvas.width=canvas.width*scale;<span class="cstat-no" title="statement not covered" >s</span>caledCanvas.height=canvas.height*scale;<span class="cstat-no" title="statement not covered" >v</span>ar srcImgData=canvas.getContext("2d").getImageData(0,0,canvas.width,canvas.height);<span class="cstat-no" title="statement not covered" >v</span>ar destImgData=scaledCanvas.getContext("2d").createImageData(scaledCanvas.width,scaledCanvas.height);<span class="cstat-no" title="statement not covered" >a</span>pplyBilinearInterpolation(srcImgData,destImgData,scale);<span class="cstat-no" title="statement not covered" >s</span>caledCanvas.getContext("2d").putImageData(destImgData,0,0);<span class="cstat-no" title="statement not covered" >r</span>eturn scaledCanvas}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar getHalfScaleCanvas=<span class="fstat-no" title="function not covered" >function(canvas){<span class="cstat-no" title="statement not covered" ></span>var halfCanvas=document.createElement("canvas");<span class="cstat-no" title="statement not covered" >h</span>alfCanvas.width=canvas.width/2;<span class="cstat-no" title="statement not covered" >h</span>alfCanvas.height=canvas.height/2;<span class="cstat-no" title="statement not covered" >h</span>alfCanvas.getContext("2d").drawImage(canvas,0,0,halfCanvas.width,halfCanvas.height);<span class="cstat-no" title="statement not covered" >r</span>eturn halfCanvas}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar applyBilinearInterpolation=<span class="fstat-no" title="function not covered" >function(srcCanvasData,destCanvasData,scale){<span class="fstat-no" title="function not covered" ></span>function inner(f00,f10,f01,f11,x,y){<span class="cstat-no" title="statement not covered" ></span>var un_x=1-x;<span class="cstat-no" title="statement not covered" >v</span>ar un_y=1-y;<span class="cstat-no" title="statement not covered" >r</span>eturn f00*un_x*un_y+f10*x*un_y+f01*un_x*y+f11*x*y}<span class="cstat-no" title="statement not covered" ></span>var i,j;<span class="cstat-no" title="statement not covered" >v</span>ar iyv,iy0,iy1,ixv,ix0,ix1;<span class="cstat-no" title="statement not covered" >v</span>ar idxD,idxS00,idxS10,idxS01,idxS11;<span class="cstat-no" title="statement not covered" >v</span>ar dx,dy;<span class="cstat-no" title="statement not covered" >v</span>ar r,g,b,a;<span class="cstat-no" title="statement not covered" >f</span>or(i=0;i&lt;destCanvasData.height;++i){<span class="cstat-no" title="statement not covered" >iyv=i/scale;<span class="cstat-no" title="statement not covered" >i</span>y0=Math.floor(iyv);<span class="cstat-no" title="statement not covered" >i</span>y1=Math.ceil(iyv)&gt;srcCanvasData.height-1?srcCanvasData.height-1:Math.ceil(iyv);<span class="cstat-no" title="statement not covered" >f</span>or(j=0;j&lt;destCanvasData.width;++j){<span class="cstat-no" title="statement not covered" >ixv=j/scale;<span class="cstat-no" title="statement not covered" >i</span>x0=Math.floor(ixv);<span class="cstat-no" title="statement not covered" >i</span>x1=Math.ceil(ixv)&gt;srcCanvasData.width-1?srcCanvasData.width-1:Math.ceil(ixv);<span class="cstat-no" title="statement not covered" >i</span>dxD=(j+destCanvasData.width*i)*4;<span class="cstat-no" title="statement not covered" >i</span>dxS00=(ix0+srcCanvasData.width*iy0)*4;<span class="cstat-no" title="statement not covered" >i</span>dxS10=(ix1+srcCanvasData.width*iy0)*4;<span class="cstat-no" title="statement not covered" >i</span>dxS01=(ix0+srcCanvasData.width*iy1)*4;<span class="cstat-no" title="statement not covered" >i</span>dxS11=(ix1+srcCanvasData.width*iy1)*4;<span class="cstat-no" title="statement not covered" >d</span>x=ixv-ix0;<span class="cstat-no" title="statement not covered" >d</span>y=iyv-iy0;<span class="cstat-no" title="statement not covered" >r</span>=inner(srcCanvasData.data[idxS00],srcCanvasData.data[idxS10],srcCanvasData.data[idxS01],srcCanvasData.data[idxS11],dx,dy);<span class="cstat-no" title="statement not covered" >d</span>estCanvasData.data[idxD]=r;<span class="cstat-no" title="statement not covered" >g</span>=inner(srcCanvasData.data[idxS00+1],srcCanvasData.data[idxS10+1],srcCanvasData.data[idxS01+1],srcCanvasData.data[idxS11+1],dx,dy);<span class="cstat-no" title="statement not covered" >d</span>estCanvasData.data[idxD+1]=g;<span class="cstat-no" title="statement not covered" >b</span>=inner(srcCanvasData.data[idxS00+2],srcCanvasData.data[idxS10+2],srcCanvasData.data[idxS01+2],srcCanvasData.data[idxS11+2],dx,dy);<span class="cstat-no" title="statement not covered" >d</span>estCanvasData.data[idxD+2]=b;<span class="cstat-no" title="statement not covered" >a</span>=inner(srcCanvasData.data[idxS00+3],srcCanvasData.data[idxS10+3],srcCanvasData.data[idxS01+3],srcCanvasData.data[idxS11+3],dx,dy);<span class="cstat-no" title="statement not covered" >d</span>estCanvasData.data[idxD+3]=a}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >r</span>eturn{scaleImage:<span class="fstat-no" title="function not covered" >function(imgData){<span class="cstat-no" title="statement not covered" ></span>img=document.createElement("img");<span class="cstat-no" title="statement not covered" >c</span>anvas=document.createElement("canvas");<span class="cstat-no" title="statement not covered" >d</span>eferred=$q.defer();<span class="cstat-no" title="statement not covered" >i</span>mg.src=imgData;<span class="cstat-no" title="statement not covered" >i</span>mg.onload=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>canvas.width=img.width;<span class="cstat-no" title="statement not covered" >c</span>anvas.height=img.height;<span class="cstat-no" title="statement not covered" >c</span>anvas.getContext("2d").drawImage(img,0,0,canvas.width,canvas.height);<span class="cstat-no" title="statement not covered" >w</span>hile(canvas.width&gt;=2*UPLOAD_IMG_MAX_WIDTH){<span class="cstat-no" title="statement not covered" >canvas=getHalfScaleCanvas(canvas)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(canvas.width&gt;UPLOAD_IMG_MAX_WIDTH){<span class="cstat-no" title="statement not covered" >canvas=scaleCanvasWithAlgorithm(canvas)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturnImageData=canvas.toDataURL("image/jpeg",1);<span class="cstat-no" title="statement not covered" >d</span>eferred.resolve(returnImageData)}</span>;<span class="cstat-no" title="statement not covered" >r</span>eturn deferred.promise}</span>}}</span>])})();</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun May 31 2015 21:26:57 GMT+0200 (VÃ¤steuropa, sommartid)</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
