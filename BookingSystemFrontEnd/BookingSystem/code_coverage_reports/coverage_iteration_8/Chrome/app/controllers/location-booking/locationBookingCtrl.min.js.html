<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for ./app/controllers/location-booking/locationBookingCtrl.min.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../../prettify.css">
    <link rel="stylesheet" href="../../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header low">
    <h1>Code coverage report for <span class="entity">./app/controllers/location-booking/locationBookingCtrl.min.js</span></h1>
    <h2>
        Statements: <span class="metric">0.97% <small>(2 / 207)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">0% <small>(0 / 49)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">2.94% <small>(2 / 68)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">100% <small>(1 / 1)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; <a href="index.html">./app/controllers/location-booking/</a> &#187; locationBookingCtrl.min.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1</td><td class="line-coverage"><span class="cline-any cline-yes">1</span></td><td class="text"><pre class="prettyprint lang-js">(function(){angular.module("bookingSystem.locationBooking",["bookingSystem.locationBookingServices","bookingSystem.commonFilters","bookingSystem.commonDirectives"]).config(["$routeProvider",function($routeProvider){}]).controller("LocationBookingShowCtrl",["$scope","$routeParams","$location","$rootScope","LocationBooking","API_IMG_PATH_URL","PHOTO_MISSING_SRC",<span class="fstat-no" title="function not covered" >function($scope,$routeParams,$location,$rootScope,LocationBooking,API_IMG_PATH_URL,PHOTO_MISSING_SRC){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >v</span>ar locationBooking=LocationBooking.get({locationBookingId:$routeParams.locationBookingId});<span class="cstat-no" title="statement not covered" >l</span>ocationBooking.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>locationBooking.LocationImageSrc=locationBooking.LocationImageSrc===""?PHOTO_MISSING_SRC:API_IMG_PATH_URL+locationBooking.LocationImageSrc}</span>);<span class="cstat-no" title="statement not covered" >l</span>ocationBooking.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Lokal/Plats-bokningen kunde inte hämtas, var god försök igen."};<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking=null}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking=locationBooking}</span>]).controller("LocationBookingListCtrl",["$scope","LocationBooking","$rootScope","$location",<span class="fstat-no" title="function not covered" >function($scope,LocationBooking,$rootScope,$location){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >v</span>ar currentDateObj;<span class="cstat-no" title="statement not covered" >t</span>hat.initDateVariables=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var yearParam=$location.search().ar;<span class="cstat-no" title="statement not covered" >v</span>ar monthParam=$location.search().manad;<span class="cstat-no" title="statement not covered" >i</span>f(typeof yearParam!=="undefined"&amp;&amp;typeof monthParam!=="undefined"){<span class="cstat-no" title="statement not covered" >currentDateObj=moment(yearParam+"-"+$BookSysUtil.String.addLeadingZero(+monthParam+1)+"-01").toDate()}</span>else{<span class="cstat-no" title="statement not covered" >currentDateObj=new Date}<span class="cstat-no" title="statement not covered" ></span>t</span>hat.currentYear=currentDateObj.getFullYear();<span class="cstat-no" title="statement not covered" >t</span>hat.currentMonth=currentDateObj.getMonth();<span class="cstat-no" title="statement not covered" >t</span>hat.currentMonthName=moment(currentDateObj).format("MMMM");<span class="cstat-no" title="statement not covered" >t</span>hat.currentMonthNumberOfDays=new Date(that.currentYear,that.currentMonth+1,0).getDate();<span class="cstat-no" title="statement not covered" >t</span>hat.currentMonthStartDateObj=new Date(that.currentYear,that.currentMonth,1);<span class="cstat-no" title="statement not covered" >t</span>hat.currentMonthEndDateObj=new Date(that.currentYear,that.currentMonth,that.currentMonthNumberOfDays)}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getLocationBookings=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>that.locationBookings=LocationBooking.queryMoreForPeriod({fromDate:moment(that.currentMonthStartDateObj).format("YYYY-MM-DD"),toDate:moment(that.currentMonthEndDateObj).format("YYYY-MM-DD")});<span class="cstat-no" title="statement not covered" >t</span>hat.locationBookings.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.noItemsFound=!that.locationBookings.length}</span>);<span class="cstat-no" title="statement not covered" >t</span>hat.locationBookings.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Bokningarna kunde inte hämtas, var god försök igen."}}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.locationBookings=that.locationBookings}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.addVarsToScope=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.currentYear=that.currentYear;<span class="cstat-no" title="statement not covered" >$</span>scope.currentMonthName=that.currentMonthName}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.changeToPreviousMonth=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(that.currentMonth==0){<span class="cstat-no" title="statement not covered" >that.currentMonth=11;<span class="cstat-no" title="statement not covered" >t</span>hat.currentYear-=1}</span>else{<span class="cstat-no" title="statement not covered" >that.currentMonth-=1}<span class="cstat-no" title="statement not covered" ></span>$</span>location.search("ar",that.currentYear);<span class="cstat-no" title="statement not covered" >$</span>location.search("manad",that.currentMonth);<span class="cstat-no" title="statement not covered" >t</span>hat.initDateVariables();<span class="cstat-no" title="statement not covered" >t</span>hat.getLocationBookings();<span class="cstat-no" title="statement not covered" >t</span>hat.addVarsToScope()}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.changeToNextMonth=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$location.search("ar",that.currentYear);<span class="cstat-no" title="statement not covered" >$</span>location.search("manad",that.currentMonth+1);<span class="cstat-no" title="statement not covered" >t</span>hat.initDateVariables();<span class="cstat-no" title="statement not covered" >t</span>hat.getLocationBookings();<span class="cstat-no" title="statement not covered" >t</span>hat.addVarsToScope()}</span>;<span class="cstat-no" title="statement not covered" >c</span>urrentDateObj=new Date;<span class="cstat-no" title="statement not covered" >t</span>hat.initDateVariables();<span class="cstat-no" title="statement not covered" >t</span>hat.getLocationBookings();<span class="cstat-no" title="statement not covered" >t</span>hat.addVarsToScope()}</span>]).controller("LocationBookingCreateCtrl",["$scope","$routeParams","$location","$rootScope","LocationBooking","LocationFurnituring","Location","BookingType","Customer","Booking","$q",<span class="fstat-no" title="function not covered" >function($scope,$routeParams,$location,$rootScope,LocationBooking,LocationFurnituring,Location,BookingType,Customer,Booking,$q){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >$</span>scope.furniturings=[];<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking={};<span class="cstat-no" title="statement not covered" >t</span>hat.getLocations=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer(),promise=deferred.promise;<span class="cstat-no" title="statement not covered" >$</span>scope.locations=Location.query();<span class="cstat-no" title="statement not covered" >$</span>scope.locations.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>deferred.resolve()}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.locations.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Lokaler kunde inte hämtas."}}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn promise}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getBookingTypes=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer(),promise=deferred.promise;<span class="cstat-no" title="statement not covered" >$</span>scope.bookingTypes=BookingType.query();<span class="cstat-no" title="statement not covered" >$</span>scope.bookingTypes.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>deferred.resolve()}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.bookingTypes.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Bokningstyper kunde inte hämtas."};<span class="cstat-no" title="statement not covered" >d</span>eferred.reject()}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn promise}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getCustomers=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer(),promise=deferred.promise;<span class="cstat-no" title="statement not covered" >$</span>scope.customers=Customer.query();<span class="cstat-no" title="statement not covered" >$</span>scope.customers.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>deferred.resolve()}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.customers.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Kunder kunde inte hämtas."};<span class="cstat-no" title="statement not covered" >d</span>eferred.reject()}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn promise}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getOtherDisplayData=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer(),promise=deferred.promise;<span class="cstat-no" title="statement not covered" >t</span>hat.getBookingTypes().then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>that.getCustomers().then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>that.getLocations().then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>deferred.resolve()}</span>)}</span>)}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn promise}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.saveBooking=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer(),promise=deferred.promise;<span class="cstat-no" title="statement not covered" >i</span>f($scope.bookingId==0){<span class="cstat-no" title="statement not covered" >promise=Booking.save({BookingId:0,Name:$scope.booking.Name,BookingTypeId:$scope.booking.BookingTypeId,CustomerId:$scope.booking.CustomerId,Provisional:!!parseInt($scope.booking.Provisional,10),NumberOfPeople:$scope.locationBooking.NumberOfPeople,Discount:0,CreatedByUserId:1,ModifiedByUserId:1,ResponsibleUserId:1}).$promise.then(<span class="fstat-no" title="function not covered" >function(createdBooking){<span class="cstat-no" title="statement not covered" ></span>$scope.bookingId=createdBooking.BookingId;<span class="cstat-no" title="statement not covered" >$</span>rootScope.FlashMessage={type:"success",message:'Bokningstillfället "'+$scope.booking.Name+'" skapades med ett lyckat resultat'};<span class="cstat-no" title="statement not covered" >d</span>eferred.resolve()}</span>).catch(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>if(response.status==409){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:'Det finns redan ett bokningstillfälle som heter "'+$scope.booking.Name+'". Två bokningstillfällen kan inte heta lika.'}}</span>else{<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när bokningstillfället skulle sparas"}}</span>}</span>)}</span>else{<span class="cstat-no" title="statement not covered" >deferred.resolve()}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn promise}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.saveLocationBooking=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer(),promise=deferred.promise;<span class="cstat-no" title="statement not covered" >L</span>ocationBooking.save({BookingId:$scope.bookingId,LocationBookingId:0,LocationId:$scope.locationBooking.LocationId,FurnituringId:$scope.locationBooking.SelectedFurnituring.FurnituringId,StartTime:moment($scope.StartDate+" "+$scope.StartTime).format(),EndTime:moment($scope.EndDate+" "+$scope.EndTime).format(),NumberOfPeople:$scope.locationBooking.NumberOfPeople}).$promise.then(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"success",message:"Lokal/plats-bokningen skapades med ett lyckat resultat"};<span class="cstat-no" title="statement not covered" >d</span>eferred.resolve()}</span>).catch(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>if(response.status==409){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Lokalen är tyvärr redan bokad under vald tidsram."}}</span>else{<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när lokal/plats-bokningen skulle sparas"}}</span>}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn promise}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getLocationsBookingInfo=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(typeof $scope.StartDate!=="undefined"&amp;&amp;typeof $scope.StartTime!=="undefined"&amp;&amp;typeof $scope.EndDate!=="undefined"&amp;&amp;typeof $scope.EndTime!=="undefined"){<span class="cstat-no" title="statement not covered" >Location.queryFreeForPeriod({fromDate:$scope.StartDate,fromTime:$scope.StartTime,toDate:$scope.EndDate,toTime:$scope.EndTime}).$promise.then(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>$scope.freeLocations=response;<span class="cstat-no" title="statement not covered" >$</span>scope.locations=response}</span>).catch(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när uppgifter om lediga lokaler skulle hämtas"}}</span>)}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.addDateWatches=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.$watch("StartDate",<span class="fstat-no" title="function not covered" >function(newValue,oldValue){<span class="cstat-no" title="statement not covered" ></span>that.getLocationsBookingInfo()}</span>,true);<span class="cstat-no" title="statement not covered" >$</span>scope.$watch("StartTime",<span class="fstat-no" title="function not covered" >function(newValue,oldValue){<span class="cstat-no" title="statement not covered" ></span>that.getLocationsBookingInfo()}</span>,true);<span class="cstat-no" title="statement not covered" >$</span>scope.$watch("EndDate",<span class="fstat-no" title="function not covered" >function(newValue,oldValue){<span class="cstat-no" title="statement not covered" ></span>that.getLocationsBookingInfo()}</span>,true);<span class="cstat-no" title="statement not covered" >$</span>scope.$watch("EndTime",<span class="fstat-no" title="function not covered" >function(newValue,oldValue){<span class="cstat-no" title="statement not covered" ></span>that.getLocationsBookingInfo()}</span>,true)}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.save=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>that.saveBooking().then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>that.saveLocationBooking().then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>history.back()}</span>)}</span>)}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.updateFurniturings=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(!!$scope.locationBooking.LocationId){<span class="cstat-no" title="statement not covered" >$scope.furniturings=LocationFurnituring.queryForLocation({locationId:$scope.locationBooking.LocationId});<span class="cstat-no" title="statement not covered" >$</span>scope.furniturings.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Möbleringar för vald lokal kunde inte hämtas."}}</span>).then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.showInfoAboutNoFurniturings=!$scope.furniturings.length}</span>)}</span>else{<span class="cstat-no" title="statement not covered" >$scope.furnituring=[]}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getOtherDisplayData();<span class="cstat-no" title="statement not covered" >$</span>scope.bookingId=$routeParams.bookingId||0;<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking.LocationId=+$location.search()["lokal-id"];<span class="cstat-no" title="statement not covered" >t</span>hat.addDateWatches()}</span>]).controller("LocationBookingEditCtrl",["$scope","$routeParams","$location","$rootScope","LocationBooking","LocationFurnituring","Location","$q",<span class="fstat-no" title="function not covered" >function($scope,$routeParams,$location,$rootScope,LocationBooking,LocationFurnituring,Location,$q){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >t</span>hat.initLocationBooking=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer(),promise=deferred.promise;<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking=LocationBooking.get({locationBookingId:$routeParams.locationBookingId});<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.StartDate=moment($scope.locationBooking.StartTime).format("YYYY-MM-DD");<span class="cstat-no" title="statement not covered" >$</span>scope.StartTime=moment($scope.locationBooking.StartTime).format("HH:mm");<span class="cstat-no" title="statement not covered" >$</span>scope.EndDate=moment($scope.locationBooking.EndTime).format("YYYY-MM-DD");<span class="cstat-no" title="statement not covered" >$</span>scope.EndTime=moment($scope.locationBooking.EndTime).format("HH:mm");<span class="cstat-no" title="statement not covered" >d</span>eferred.resolve()}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Lokal/plats-bokningen kunde inte hämtas, var god försök igen."};<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking=null}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn promise}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getLocations=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer(),promise=deferred.promise;<span class="cstat-no" title="statement not covered" >$</span>scope.locations=Location.query();<span class="cstat-no" title="statement not covered" >$</span>scope.locations.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>deferred.resolve()}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.locations.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Lokaler kunde inte hämtas."}}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn promise}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.save=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>LocationBooking.save({BookingId:$scope.locationBooking.BookingId,LocationBookingId:$routeParams.locationBookingId,LocationId:$scope.locationBooking.LocationId,FurnituringId:$scope.locationBooking.SelectedFurnituring.FurnituringId,StartTime:moment($scope.StartDate+" "+$scope.StartTime).format(),EndTime:moment($scope.EndDate+" "+$scope.EndTime).format(),NumberOfPeople:$scope.locationBooking.NumberOfPeople}).$promise.then(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"success",message:"Lokal/plats-bokningen sparades med ett lyckat resultat"};<span class="cstat-no" title="statement not covered" >h</span>istory.back()}</span>).catch(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>if(response.status==409){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Det finns redan en annan lokal/plats-bokning som krockar med den här bokningen."}}</span>else <span class="cstat-no" title="statement not covered" >if(response.status==400||response.status==500){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när lokal/plats-bokningen skulle sparas"}}<span class="cstat-no" title="statement not covered" ></span>i</span></span>f(response.status==404){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Lokal/plats-bokningen existerar inte längre. Hann kanske någon radera den?"};<span class="cstat-no" title="statement not covered" >h</span>istory.back()}</span>}</span>)}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.updateFurniturings=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var i;<span class="cstat-no" title="statement not covered" >i</span>f(!!$scope.locationBooking.LocationId){<span class="cstat-no" title="statement not covered" >$scope.furniturings=LocationFurnituring.queryForLocation({locationId:$scope.locationBooking.LocationId});<span class="cstat-no" title="statement not covered" >$</span>scope.furniturings.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Möbleringar för vald lokal kunde inte hämtas."}}</span>).then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.showInfoAboutNoFurniturings=!$scope.furniturings.length;<span class="cstat-no" title="statement not covered" >f</span>or(i=0;i&lt;$scope.furniturings.length;i++){<span class="cstat-no" title="statement not covered" >if($scope.locationBooking.FurnituringId==$scope.furniturings[i].FurnituringId){<span class="cstat-no" title="statement not covered" >$scope.locationBooking.SelectedFurnituring=$scope.furniturings[i]}</span>}</span>}</span>)}</span>else{<span class="cstat-no" title="statement not covered" >$scope.furnituring=[]}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.initLocationBooking().then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>that.getLocations().then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.updateFurniturings()}</span>)}</span>)}</span>]).controller("LocationBookingDeleteCtrl",["$scope","$routeParams","LocationBooking","$location","$rootScope","PHOTO_MISSING_SRC","API_IMG_PATH_URL",<span class="fstat-no" title="function not covered" >function($scope,$routeParams,LocationBooking,$location,$rootScope,PHOTO_MISSING_SRC,API_IMG_PATH_URL){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >$</span>scope.confirm=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>LocationBooking.delete({locationBookingId:$routeParams.locationBookingId}).$promise.then(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"success",message:"Lokal/plats-bokningen raderades med ett lyckat resultat"};<span class="cstat-no" title="statement not covered" >h</span>istory.back()}</span>).catch(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>if(response.status==400&amp;&amp;response.data.Message!=="undefined"&amp;&amp;response.data.Message==="Foreign key references exists"){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Lokal/plats-bokningen kan inte raderas eftersom det finns"+" någonting som refererar till lokal/plats-bokningen"}}</span>else <span class="cstat-no" title="statement not covered" >if(response.status==400||response.status==500){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när lokal/plats-bokningen skulle tas bort"}}<span class="cstat-no" title="statement not covered" ></span>i</span></span>f(response.status==404){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Lokal/plats-bokningen existerar inte längre. Hann kanske någon radera den?"}}<span class="cstat-no" title="statement not covered" ></span>h</span>istory.back()}</span>)}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar locationBooking=LocationBooking.get({locationBookingId:$routeParams.locationBookingId});<span class="cstat-no" title="statement not covered" >l</span>ocationBooking.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>locationBooking.LocationImageSrc=locationBooking.LocationImageSrc===""?PHOTO_MISSING_SRC:API_IMG_PATH_URL+locationBooking.LocationImageSrc}</span>);<span class="cstat-no" title="statement not covered" >l</span>ocationBooking.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Lokal/plats-bokningen kunde inte hämtas, var god försök igen."};<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking=null}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.locationBooking=locationBooking}</span>])})();</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun May 31 2015 21:26:57 GMT+0200 (Västeuropa, sommartid)</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
