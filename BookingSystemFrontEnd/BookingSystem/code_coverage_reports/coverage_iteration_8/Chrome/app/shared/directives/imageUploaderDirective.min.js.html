<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for ./app/shared/directives/imageUploaderDirective.min.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../../prettify.css">
    <link rel="stylesheet" href="../../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header low">
    <h1>Code coverage report for <span class="entity">./app/shared/directives/imageUploaderDirective.min.js</span></h1>
    <h2>
        Statements: <span class="metric">4.44% <small>(2 / 45)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">0% <small>(0 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">5.26% <small>(1 / 19)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">100% <small>(1 / 1)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; <a href="index.html">./app/shared/directives/</a> &#187; imageUploaderDirective.min.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1</td><td class="line-coverage"><span class="cline-any cline-yes">1</span></td><td class="text"><pre class="prettyprint lang-js">(function(){angular.module("bookingSystem.imageUploaderDirective",["bookingSystem.imageResizeServices"]).controller("imageUploaderCtrl",["$scope","$q","$element","$attrs","$rootScope","LocationImage","ImageResize","API_IMG_PATH_URL","PHOTO_MISSING_SRC",<span class="fstat-no" title="function not covered" >function($scope,$q,$element,$attrs,$rootScope,LocationImage,ImageResize,API_IMG_PATH_URL,PHOTO_MISSING_SRC){<span class="cstat-no" title="statement not covered" ></span>var that=this,i;<span class="cstat-no" title="statement not covered" >$</span>scope.file="";<span class="cstat-no" title="statement not covered" >$</span>scope.progress=0;<span class="cstat-no" title="statement not covered" >$</span>scope.isProgressVisible=false;<span class="cstat-no" title="statement not covered" >t</span>hat.onLoad=<span class="fstat-no" title="function not covered" >function(reader,deferred){<span class="cstat-no" title="statement not covered" ></span>return <span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.$apply(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>ImageResize.scaleImage(reader.result).then(<span class="fstat-no" title="function not covered" >function(imgData){<span class="cstat-no" title="statement not covered" ></span>$scope.displayImageSrc=imgData;<span class="cstat-no" title="statement not covered" >$</span>scope.base64EncodedImage=imgData.replace(/^data:image\/jpeg;base64,/,"");<span class="cstat-no" title="statement not covered" >d</span>eferred.resolve()}</span>)}</span>)}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.onError=<span class="fstat-no" title="function not covered" >function(reader,deferred){<span class="cstat-no" title="statement not covered" ></span>return <span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.$apply(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>deferred.reject(reader.result)}</span>)}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.onProgress=<span class="fstat-no" title="function not covered" >function(reader){<span class="cstat-no" title="statement not covered" ></span>return <span class="fstat-no" title="function not covered" >function(event){</span>}}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.checkFile=<span class="fstat-no" title="function not covered" >function(file){<span class="cstat-no" title="statement not covered" ></span>if(file.type=="image/png"||file.type=="image/jpg"||file.type=="image/jpeg"||file.type=="image/gif"){<span class="cstat-no" title="statement not covered" >if(file.size&lt;1e7){<span class="cstat-no" title="statement not covered" >return true}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.$watch("imageSrc",<span class="fstat-no" title="function not covered" >function(newValue,oldValue){<span class="cstat-no" title="statement not covered" ></span>if(typeof newValue!=="undefined"&amp;&amp;newValue!==""){<span class="cstat-no" title="statement not covered" >$scope.displayImageSrc=API_IMG_PATH_URL+newValue+"?"+Date.now()}</span>else{<span class="cstat-no" title="statement not covered" >$scope.displayImageSrc=PHOTO_MISSING_SRC}</span>}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.readUploadedFile=<span class="fstat-no" title="function not covered" >function(file){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer();<span class="cstat-no" title="statement not covered" >v</span>ar reader=new FileReader;<span class="cstat-no" title="statement not covered" >i</span>f(that.checkFile(file)){<span class="cstat-no" title="statement not covered" >reader.onload=that.onLoad(reader,deferred);<span class="cstat-no" title="statement not covered" >r</span>eader.onerror=that.onError(reader,deferred);<span class="cstat-no" title="statement not covered" >r</span>eader.onprogress=that.onProgress(reader);<span class="cstat-no" title="statement not covered" >r</span>eader.readAsDataURL(file);<span class="cstat-no" title="statement not covered" >r</span>eturn deferred.promise}</span>else{<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Den uppladdade bilden måste vara av typen: jpg, gif eller png och får inte överstiga 10mb i storlek"};<span class="cstat-no" title="statement not covered" >d</span>eferred.reject();<span class="cstat-no" title="statement not covered" >r</span>eturn deferred.promise}</span>}</span>}</span>]).directive("imageUploader",["$http",<span class="fstat-no" title="function not covered" >function($http){<span class="cstat-no" title="statement not covered" ></span>return{restrict:"E",link:<span class="fstat-no" title="function not covered" >function(scope,elm,attrs){</span>},scope:{imageSrc:"=imageSrc",base64EncodedImage:"=base64EncodedImage"},replace:true,templateUrl:"shared/directives/imageUploaderDirective.html",controller:"imageUploaderCtrl"}}</span>]).directive("imageUploaderFile",<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return{restrict:"A",replace:false,scope:false,controller:["$scope","$element","$attrs",<span class="fstat-no" title="function not covered" >function($scope,$element,$attrs){<span class="cstat-no" title="statement not covered" ></span>$element.bind("change",<span class="fstat-no" title="function not covered" >function(event){<span class="cstat-no" title="statement not covered" ></span>var file;<span class="cstat-no" title="statement not covered" >f</span>ile=(event.srcElement||event.target).files[0];<span class="cstat-no" title="statement not covered" >$</span>scope.readUploadedFile(file)}</span>)}</span>]}}</span>)})();</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun May 31 2015 21:26:57 GMT+0200 (Västeuropa, sommartid)</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
