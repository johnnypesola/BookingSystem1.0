<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for ./app/controllers/booking/bookingCtrl.min.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../../prettify.css">
    <link rel="stylesheet" href="../../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header low">
    <h1>Code coverage report for <span class="entity">./app/controllers/booking/bookingCtrl.min.js</span></h1>
    <h2>
        Statements: <span class="metric">31.34% <small>(42 / 134)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">23.81% <small>(5 / 21)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">19.57% <small>(9 / 46)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">100% <small>(1 / 1)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; <a href="index.html">./app/controllers/booking/</a> &#187; bookingCtrl.min.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1</td><td class="line-coverage"><span class="cline-any cline-yes">7</span></td><td class="text"><pre class="prettyprint lang-js">(function(){angular.module("bookingSystem.booking",["bookingSystem.bookingServices","bookingSystem.commonFilters","bookingSystem.calendarDirective","bookingSystem.customerServices"]).config(["$routeProvider",function($routeProvider){}]).controller("BookingShowCtrl",["$scope","$routeParams","$location","$rootScope","Booking",<span class="fstat-no" title="function not covered" >function($scope,$routeParams,$location,$rootScope,Booking){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >v</span>ar booking=Booking.get({bookingId:$routeParams.bookingId});<span class="cstat-no" title="statement not covered" >b</span>ooking.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.noLocationBookingsFound=!booking.LocationBookings.length}</span>);<span class="cstat-no" title="statement not covered" >b</span>ooking.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Bokningstillfället kunde inte hämtas, var god försök igen."};<span class="cstat-no" title="statement not covered" >$</span>scope.booking=null}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.booking=booking}</span>]).controller("BookingDeleteCtrl",["$scope","$routeParams","$location","$rootScope","Booking","Redirect",<span class="fstat-no" title="function not covered" >function($scope,$routeParams,$location,$rootScope,Booking,Redirect){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >$</span>scope.confirm=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>Booking.delete({bookingId:$routeParams.bookingId}).$promise.then(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"success",message:"Bokningstillfället och dess underliggande Lokal/plats-bokningar raderades med ett lyckat resultat"};<span class="cstat-no" title="statement not covered" >R</span>edirect.to("lista")}</span>).catch(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>if(response.status==400&amp;&amp;response.data.Message!=="undefined"&amp;&amp;response.data.Message==="Foreign key references exists"){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Bokningstillfället kan inte raderas eftersom det finns"+" någonting som refererar till bokningstillfället"}}</span>else <span class="cstat-no" title="statement not covered" >if(response.status==400||response.status==500){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när bokningstillfället skulle tas bort"}}<span class="cstat-no" title="statement not covered" ></span>i</span></span>f(response.status==404){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Bokningstillfället existerar inte längre. Hann kanske någon radera den?"}}<span class="cstat-no" title="statement not covered" ></span>h</span>istory.back()}</span>)}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar booking=Booking.get({bookingId:$routeParams.bookingId});<span class="cstat-no" title="statement not covered" >b</span>ooking.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Bokningstillfället kunde inte hämtas, var god försök igen."};<span class="cstat-no" title="statement not covered" >$</span>scope.booking=null}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.booking=booking}</span>]).controller("BookingListCtrl",["$scope","Booking","$rootScope","$location",function($scope,Booking,$rootScope,$location){var that=this;var currentDateObj;that.initDateVariables=function(){var yearParam=$location.search().ar;var monthParam=$location.search().manad;if(typeof yearParam!=="undefined"&amp;&amp;typeof monthParam!=="undefined"){currentDateObj=moment(yearParam+"-"+$BookSysUtil.String.addLeadingZero(+monthParam+1)+"-01").toDate()}else{currentDateObj=new Date}that.currentYear=currentDateObj.getFullYear();that.currentMonth=currentDateObj.getMonth();that.currentMonthName=moment(currentDateObj).format("MMMM");that.currentMonthNumberOfDays=new Date(that.currentYear,that.currentMonth+1,0).getDate();that.currentMonthStartDateObj=new Date(that.currentYear,that.currentMonth,1);that.currentMonthEndDateObj=new Date(that.currentYear,that.currentMonth,that.currentMonthNumberOfDays)};that.getBookings=function(){that.bookings=Booking.queryMoreForPeriod({fromDate:moment(that.currentMonthStartDateObj).format("YYYY-MM-DD"),toDate:moment(that.currentMonthEndDateObj).format("YYYY-MM-DD")});that.bookings.$promise.then(function(){$scope.noItemsFound=!that.bookings.length});that.bookings.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Bokningarna kunde inte hämtas, var god försök igen."}}</span>);$scope.bookings=that.bookings};that.addVarsToScope=function(){$scope.currentYear=that.currentYear;$scope.currentMonthName=that.currentMonthName};$scope.changeToPreviousMonth=function(){<span class="missing-if-branch" title="if path not taken" >I</span>if(that.currentMonth==0){<span class="cstat-no" title="statement not covered" >that.currentMonth=11;<span class="cstat-no" title="statement not covered" >t</span>hat.currentYear-=1}</span>else{that.currentMonth-=1}$location.search("ar",that.currentYear);$location.search("manad",that.currentMonth);that.initDateVariables();that.getBookings();that.addVarsToScope()};$scope.changeToNextMonth=function(){$location.search("ar",that.currentYear);$location.search("manad",that.currentMonth+1);that.initDateVariables();that.getBookings();that.addVarsToScope()};that.initDateVariables();that.getBookings();that.addVarsToScope()}]).controller("BookingListEmptyCtrl",["$scope","Booking","$rootScope","$location",<span class="fstat-no" title="function not covered" >function($scope,Booking,$rootScope,$location){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >v</span>ar currentDateObj;<span class="cstat-no" title="statement not covered" >t</span>hat.getBookings=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>that.bookings=Booking.queryEmpty();<span class="cstat-no" title="statement not covered" >t</span>hat.bookings.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.noItemsFound=!that.bookings.length}</span>);<span class="cstat-no" title="statement not covered" >t</span>hat.bookings.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Bokningarna kunde inte hämtas, var god försök igen."}}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.bookings=that.bookings}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getBookings()}</span>]).controller("BookingCreateCtrl",["$scope","Booking","$rootScope","Customer","BookingType","Redirect",<span class="fstat-no" title="function not covered" >function($scope,Booking,$rootScope,Customer,BookingType,Redirect){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >v</span>ar currentDateObj;<span class="cstat-no" title="statement not covered" >t</span>hat.getOtherDisplayData=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.customers=Customer.query();<span class="cstat-no" title="statement not covered" >$</span>scope.customers.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.bookingTypes=BookingType.query();<span class="cstat-no" title="statement not covered" >$</span>scope.bookingTypes.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Bokningstyper kunde inte hämtas."}}</span>)}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.customers.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Kunder kunde inte hämtas."}}</span>)}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.save=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>Booking.save({BookingId:0,Name:$scope.booking.Name,BookingTypeId:$scope.booking.BookingTypeId,CustomerId:$scope.booking.CustomerId,Provisional:!!parseInt($scope.booking.Provisional,10),NumberOfPeople:$scope.booking.NumberOfPeople,Discount:$scope.booking.Discount,Notes:$scope.booking.Notes,CreatedByUserId:1,ModifiedByUserId:1,ResponsibleUserId:1}).$promise.then(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"success",message:"Bokningstillfället skapades med ett lyckat resultat"};<span class="cstat-no" title="statement not covered" >R</span>edirect.to("visa/",response.BookingId)}</span>).catch(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>if(response.status==409){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:'Det finns redan ett bokningstillfälle som heter "'+$scope.booking.Name+'". Två bokningstillfällen kan inte heta lika.'}}</span>else{<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när bokningstillfället skulle sparas"}}</span>}</span>)}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getOtherDisplayData()}</span>]).controller("BookingEditCtrl",["$scope","Booking","$rootScope","Customer","BookingType","$q","$routeParams",<span class="fstat-no" title="function not covered" >function($scope,Booking,$rootScope,Customer,BookingType,$q,$routeParams){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >v</span>ar currentDateObj;<span class="cstat-no" title="statement not covered" >t</span>hat.getBooking=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var deferred=$q.defer(),promise=deferred.promise;<span class="cstat-no" title="statement not covered" >$</span>scope.booking=Booking.get({bookingId:$routeParams.bookingId});<span class="cstat-no" title="statement not covered" >$</span>scope.booking.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>deferred.resolve()}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.booking.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Bokningstillfället kunde inte hämtas, var god försök igen."};<span class="cstat-no" title="statement not covered" >$</span>scope.booking=null}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn promise}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getOtherDisplayData=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.customers=Customer.query();<span class="cstat-no" title="statement not covered" >$</span>scope.customers.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.bookingTypes=BookingType.query();<span class="cstat-no" title="statement not covered" >$</span>scope.bookingTypes.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Bokningstyper kunde inte hämtas."}}</span>)}</span>);<span class="cstat-no" title="statement not covered" >$</span>scope.customers.$promise.catch(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Kunder kunde inte hämtas."}}</span>)}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.save=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>Booking.save({BookingId:$scope.booking.BookingId,Name:$scope.booking.Name,BookingTypeId:$scope.booking.BookingTypeId,CustomerId:$scope.booking.CustomerId,Provisional:!!parseInt($scope.booking.Provisional,10),NumberOfPeople:$scope.booking.NumberOfPeople,Discount:$scope.booking.Discount,Notes:$scope.booking.Notes,CreatedByUserId:1,ModifiedByUserId:1,ResponsibleUserId:1}).$promise.then(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"success",message:"Bokningstillfället sparades med ett lyckat resultat"};<span class="cstat-no" title="statement not covered" >h</span>istory.back()}</span>).catch(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>if(response.status==409){<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:'Det finns redan ett bokningstillfälle som heter "'+$scope.booking.Name+'". Två bokningstillfällen kan inte heta lika.'}}</span>else{<span class="cstat-no" title="statement not covered" >$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när bokningstillfället skulle sparas"}}</span>}</span>)}</span>;<span class="cstat-no" title="statement not covered" >t</span>hat.getBooking().then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>that.getOtherDisplayData()}</span>)}</span>]).controller("BookingSearchCtrl",["$scope","Booking","$rootScope",<span class="fstat-no" title="function not covered" >function($scope,Booking,$rootScope){<span class="cstat-no" title="statement not covered" ></span>var that=this;<span class="cstat-no" title="statement not covered" >v</span>ar currentDateObj;<span class="cstat-no" title="statement not covered" >$</span>scope.search=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.searchResults=Booking.querySearch({column:$scope.searchColumn,value:$scope.searchValue});<span class="cstat-no" title="statement not covered" >$</span>scope.searchResults.$promise.then(<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>$scope.noSearchResultsFound=!$scope.searchResults.length}</span>).catch(<span class="fstat-no" title="function not covered" >function(response){<span class="cstat-no" title="statement not covered" ></span>$rootScope.FlashMessage={type:"error",message:"Ett oväntat fel uppstod när sökresultaten hämtades. Var god försök igen."}}</span>)}</span>;<span class="cstat-no" title="statement not covered" >$</span>scope.searchColumn="Name"}</span>])})();</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun May 31 2015 21:26:57 GMT+0200 (Västeuropa, sommartid)</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
